# Main README

## Project Description

The project is dedicated to developing a service for enhancing the resolution and detail of anime videos using modern computer vision technologies. The main goal of the project is to transform low-quality video materials (Low Resolution, LR) into high-quality ones (High Resolution, HR) while preserving authentic details and the stylistic elements of anime. The project consists of three main modules, each performing specific tasks:

1. **Dataset Preparation Module** — a module for dataset preparation, including frame extraction from videos, filtering out low-quality images, and removing duplicates.
2. **Video Upscaling Inference Module** — a module for video processing using the **RRDBNet** model and TensorRT optimization for improved GPU performance.
3. **Main Module** — used for train and image inference.

## Main Workflow

1. **Video Processing:**
   - The video file is split into individual frames.
   - Frames are cleaned from noise and artifacts.

2. **Data Preparation for Training:**
   - High-quality images (HR) are collected to create a training dataset.
   - Low-quality images (LR) are generated by adding noise and artificially reducing resolution.

3. **Model Training:**
   - A Generative Adversarial Network (GAN) is trained on pairs of HR and LR images.
   - LR images are used as input, while HR images serve as targets.
   - The model learns to restore details and increase the resolution of LR images to match HR targets as closely as possible.

4. **Integration and Automation:**
   - A service is developed that takes video as input, splits it into frames, enhances the quality of each frame, and then reassembles the video.


## Project Structure

The project consists of the following parts:

1. **[Dataset Preparation Module](dataset_preparation/)** — a module for dataset preparation. Detailed description and usage instructions can be found in [README.md](dataset_preparation/README.md).
2. **[Video Upscaling Inference Module](inference_video/)** — a module for video processing. Detailed description and usage instructions can be found in [README.md](inference_video/README.md).
3. **[Main Module](README.md)** — integration of all components and project description. Can be used for training/inference. You are here.

## Installation

To set up the project, follow these steps:

1. **Clone the repository:**
   ```
   git clone <repository_url>
   cd <repository_directory>
   ```

2. **Install dependencies:**
   - Install the required Python packages using the `requirements.txt` file:
     ```
     pip install -r requirements.txt
     ```

3. **Download assets:**
   - Run the `download_assets.sh` script to download pre-trained models and other necessary assets:
     ```
     ./download_assets.sh
     ```
4. For dataset preparation and video inference also follow the following instructions: [dataset preparation](dataset_preparation/README.md) and [inference_video](inference_video/README.md)
## Usage

### Training
- After preparing the dataset, you can train the model using the `train.py` script:
  ```
  python train.py
  ```
  - This script will train the GAN model on the prepared dataset (HR and LR image pairs).

### Inference
- Once the model is trained, you can perform inference (image upscaling) using the `inference.py` script:
  ```
  python inference.py
  ```
  - This script will take low-resolution images as input and generate high-resolution outputs using the trained model.

## Dataset Creation

The dataset for training, validation, and testing was created from anime series listed below. Each video file was split into frames, after which low-quality images and duplicates were removed.
You can create your own dataset, follow the [instruction](dataset_preparation/README.md).

### Anime Used for Dataset Creation

#### Train Dataset
- **Jujutsu Kaisen S2** - Episodes: 1, 5, 8, 12, 16, 21
- **Oshi No Ko S2** - Episodes: 1, 4, 8, 10
- **Dededede** - Episodes: 4, 8, 11, 15
- **Dungeon Meshi** - Episodes: 1, 3, 7, 11, 15, 19, 22, 24
- **Fruits Basket the Final** - Episodes: 3, 8, 11, 13
- **Giji Harem** - Episodes: 2, 5, 9, 11
- **Kaguya-sama wa Kokurasetai: Ultra Romantic** - Episodes: 4, 6, 10, 13
- **Karasu wa Aruji o Erabanai** - Episodes: 5, 9, 12, 16
- **Kusuriya no Hitorigoto** - Episodes: 4, 7, 10, 14, 18, 21
- **Make Heroine ga Oosugiru!** - Episodes: 2, 5, 7, 10
- **Nige Jouzu no Wakagimi** - Episodes: 1, 4, 6, 9
- **Re:Zero kara Hajimeru Isekai Seikatsu S3** - Episodes: 1, 2, 3
- **Sousou no Frieren** - Episodes: 4, 7, 10, 14, 18, 22, 25, 27
- **Tsue to Tsurugi no Wistoria** - Episodes: 1, 4, 6, 9
- **Vinland Saga S2** - Episodes: 3, 7, 12, 16, 19, 21
- **Kimi ni Todoke S3** - Episodes: 1, 2, 3, 4, 5
- **Pluto** - Episodes: 1, 3, 6, 8
- **Karakai Jouzu no Takagi-san S3** - Episodes: 1, 3, 4, 7, 10, 12
- **Kage no Jitsuryokusha ni Naritakute! S2** - Episodes: 1, 3, 5, 8, 10, 12
- **Chi. Chikyuu no Undou ni Tsuite** - Episodes: 1, 4, 6, 9, 12, 15
- **Kaijuu 8-gou** - Episodes: 2, 6, 9, 12
- **Ore dake Level Up na Ken** - Episodes: 1, 3, 5, 7, 9, 11
- **Kimetsu no Yaiba: Katanakaji no Sato-hen** - Episodes: 1, 3, 5, 7, 9, 11
- **Ao Ashi** - Episodes: 1, 5, 9, 12, 15, 18, 20, 22, 24
- **Dr. Stone: New World S3** - Episodes: 1, 3, 5, 7, 9, 11
- **Horimiya: Piece** - Episodes: 1, 3, 5, 7, 9, 11, 12, 13
- **Lycoris Recoil** - Episodes: 1, 3, 5, 7, 9, 11, 12, 13

**Total:** 146 videos, 127.9 thousand .png files, 351.79 GB in size.

#### Val Dataset
- **Dandadan** - Episodes: 3, 10
- **Spy x Family** - Episodes: 2, 8
- **Bocchi the Rock** - Episodes: 3, 8
- **Tengoku Daimakyou** - Episodes: 1, 9
- **Lycoris Recoil** - Episodes: 3, 12

**Total:** 9.9 thousand .png files, 37.9 GB in size.

#### Test Dataset
- **Spy x Family** - Episodes: 5, 11
- **Bocchi the Rock** - Episodes: 5, 11
- **Mob Psycho 100 S3** - Episodes: 5, 11
- **Kimi wa Houkago Insomnia** - Episodes: 5, 11
- **Atarashii Joushi wa Do Tennen** - Episodes: 5, 11

**Total:** 10.1 thousand .png files, 35.77 GB in size.

